sudo: required
dist: trusty
os: linux
language: generic
services: docker
env:
  global:
  - secure: https://docs.travis-ci.com/user/environment-variables/#encrypting-environment-variables
  - GIT_NAME: Travis CI
  - GIT_EMAIL: builds@travis-ci.org
  - TRAVIS_REPO_SLUG: jacek-jonca/diversity-newspaper
  - GIT_BRANCH: master
  - secure: "${GH_TOKEN}"
script:
- "./changefile.sh"
- docker run --mount src=$TRAVIS_BUILD_DIR,target=/usr/src/tex,type=bind dxjoke/tectonic-docker
  /bin/sh -c "tectonic diversity.tex"
before_deploy:
- "./deploy.sh"
deploy:
  provider: releases
  api_key:
    secure: "${GH_TOKEN}"
  file:
  - diversity.pdf
  skip_cleanup: true
  on:
    repo: jacek-jonca/diversity-newspaper
    tags: false
    all_branches: true
notifications:
  email: false
